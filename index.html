
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
      
        <link rel="next" href="developer/">
      
      
      <link rel="icon" href="assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.12">
    
    
      
        <title>My Docs</title>
      
    
    
      <link rel="stylesheet" href="assets/stylesheets/main.2afb09e1.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="assets/_mkdocstrings.css">
    
    <script>__md_scope=new URL(".",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    <body dir="ltr">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#torchview" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="." title="My Docs" class="md-header__button md-logo" aria-label="My Docs" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            My Docs
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              torchview
            
          </span>
        </div>
      </div>
    </div>
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="." title="My Docs" class="md-nav__button md-logo" aria-label="My Docs" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    My Docs
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    torchview
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="." class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    torchview
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#useful-features" class="md-nav__link">
    <span class="md-ellipsis">
      Useful features
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#installation" class="md-nav__link">
    <span class="md-ellipsis">
      Installation
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#how-to-use" class="md-nav__link">
    <span class="md-ellipsis">
      How To Use
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#notebook-examples" class="md-nav__link">
    <span class="md-ellipsis">
      Notebook Examples
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#supported-features" class="md-nav__link">
    <span class="md-ellipsis">
      Supported Features
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#documentation" class="md-nav__link">
    <span class="md-ellipsis">
      Documentation
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#examples" class="md-nav__link">
    <span class="md-ellipsis">
      Examples
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Examples">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#rolled-version-of-recursive-networks" class="md-nav__link">
    <span class="md-ellipsis">
      Rolled Version of Recursive Networks
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#showhide-intermediate-hidden-tensors-and-functionals" class="md-nav__link">
    <span class="md-ellipsis">
      Show/Hide intermediate (hidden) tensors and Functionals
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#resnet-skip-connection-support-for-torch-operations-nested-modules" class="md-nav__link">
    <span class="md-ellipsis">
      ResNet / Skip Connection / Support for Torch operations / Nested Modules
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#todo" class="md-nav__link">
    <span class="md-ellipsis">
      TODO
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#contributing" class="md-nav__link">
    <span class="md-ellipsis">
      Contributing
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#references" class="md-nav__link">
    <span class="md-ellipsis">
      References
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Developer
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Developer
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="developer/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Developer
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="developer/docs/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Documentation
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="developer/rolling_graph/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    How to identify nodes and roll recursive graphs ?
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="developer/torch_function_notes/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    torch_function
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Reference
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Reference
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="reference/computation_graph/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Computation graph
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="reference/recorder_tensor/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Recorder tensor
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="reference/torchview/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Torchview
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="reference/utils/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Utils
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_5" >
        
          
          <label class="md-nav__link" for="__nav_3_5" id="__nav_3_5_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Computation node
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_5">
            <span class="md-nav__icon md-icon"></span>
            Computation node
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="reference/computation_node/base_node/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Base node
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="reference/computation_node/compute_node/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Compute node
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Tutorial
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            Tutorial
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="tutorial/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Tutorial
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="tutorial/example_introduction/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Example introduction
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#useful-features" class="md-nav__link">
    <span class="md-ellipsis">
      Useful features
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#installation" class="md-nav__link">
    <span class="md-ellipsis">
      Installation
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#how-to-use" class="md-nav__link">
    <span class="md-ellipsis">
      How To Use
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#notebook-examples" class="md-nav__link">
    <span class="md-ellipsis">
      Notebook Examples
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#supported-features" class="md-nav__link">
    <span class="md-ellipsis">
      Supported Features
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#documentation" class="md-nav__link">
    <span class="md-ellipsis">
      Documentation
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#examples" class="md-nav__link">
    <span class="md-ellipsis">
      Examples
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Examples">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#rolled-version-of-recursive-networks" class="md-nav__link">
    <span class="md-ellipsis">
      Rolled Version of Recursive Networks
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#showhide-intermediate-hidden-tensors-and-functionals" class="md-nav__link">
    <span class="md-ellipsis">
      Show/Hide intermediate (hidden) tensors and Functionals
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#resnet-skip-connection-support-for-torch-operations-nested-modules" class="md-nav__link">
    <span class="md-ellipsis">
      ResNet / Skip Connection / Support for Torch operations / Nested Modules
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#todo" class="md-nav__link">
    <span class="md-ellipsis">
      TODO
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#contributing" class="md-nav__link">
    <span class="md-ellipsis">
      Contributing
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#references" class="md-nav__link">
    <span class="md-ellipsis">
      References
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  



<h1 id="torchview">torchview</h1>
<p><a href="https://www.python.org/downloads/release/python-370/"><img alt="Python 3.7+" src="https://img.shields.io/badge/python-3.7+-blue.svg" /></a>
<a href="https://badge.fury.io/py/torchview"><img alt="PyPI version" src="https://badge.fury.io/py/torchview.svg" /></a>
<a href="https://anaconda.org/conda-forge/torchview"><img alt="Conda version" src="https://img.shields.io/conda/vn/conda-forge/torchview" /></a>
<a href="https://github.com/mert-kurttutan/torchview/actions/workflows/test.yml"><img alt="Build Status" src="https://github.com/mert-kurttutan/torchview/actions/workflows/test.yml/badge.svg" /></a>
<a href="https://github.com/mert-kurttutan/torchview/blob/main/LICENSE"><img alt="GitHub license" src="https://img.shields.io/github/license/mert-kurttutan/torchview" /></a>
<a href="https://codecov.io/gh/mert-kurttutan/torchview"><img alt="codecov" src="https://codecov.io/gh/mert-kurttutan/torchview/branch/main/graph/badge.svg" /></a>
<a href="https://pepy.tech/project/torchview"><img alt="Downloads" src="https://pepy.tech/badge/torchview" /></a></p>
<p>Torchview provides visualization of pytorch models in the form of visual graphs. Visualization includes tensors, modules, torch.functions and info such as input/output shapes.</p>
<p>Pytorch version of <code>plot_model of keras</code> (and more)</p>
<p>Supports PyTorch versions $\geq$ 1.7.</p>
<h2 id="useful-features">Useful features</h2>
<p><img alt="Useful Features" src="https://user-images.githubusercontent.com/88637659/213171745-7acf07df-6578-4a50-a106-1a7b368f8d6c.svg#gh-dark-mode-only" /><img alt="Useful Features" src="https://user-images.githubusercontent.com/88637659/213173736-6e91724c-8de1-4568-9d52-297b4b5ff0d2.svg#gh-light-mode-only" /></p>
<h2 id="installation">Installation</h2>
<p>First, you need to install graphviz,</p>
<pre><code class="language-Bash">pip install graphviz
</code></pre>
<p>For python interface of graphiz to work, you need to have dot layout command working in your system. If it isn't already installed, I suggest you run the following depeding on your OS,</p>
<p>Debian-based Linux distro (e.g. Ubuntu):</p>
<pre><code class="language-Bash">apt-get install graphviz
</code></pre>
<p>Windows:</p>
<pre><code class="language-Bash">choco install graphviz
</code></pre>
<p>macOS</p>
<pre><code class="language-Bash">brew install graphviz
</code></pre>
<p>see more details <a href="https://graphviz.readthedocs.io/en/stable/manual.html">here</a></p>
<p>Then, continue with installing torchview using pip</p>
<pre><code class="language-Bash">pip install torchview
</code></pre>
<p>or if you want via conda</p>
<pre><code class="language-Bash">conda install -c conda-forge torchview
</code></pre>
<p>or if you want most up-to-date version, install directly from repo</p>
<pre><code class="language-Bash">pip install git+https://github.com/mert-kurttutan/torchview.git
</code></pre>
<h2 id="how-to-use">How To Use</h2>
<pre><code class="language-python">from torchview import draw_graph

model = MLP()
batch_size = 2
# device='meta' -&gt; no memory is consumed for visualization
model_graph = draw_graph(model, input_size=(batch_size, 128), device='meta')
model_graph.visual_graph
</code></pre>
<p><img alt="output" src="https://user-images.githubusercontent.com/88637659/206028431-b114f48e-6307-4ff3-b31a-a74185eb61b5.png" /></p>
<h2 id="notebook-examples">Notebook Examples</h2>
<p>For more examples, see colab notebooks below,</p>
<p><strong>Introduction Notebook:</strong> <a href="https://colab.research.google.com/github/mert-kurttutan/torchview/blob/main/docs/example_introduction.ipynb"><img alt="Introduction" src="https://colab.research.google.com/assets/colab-badge.svg" /></a></p>
<p><strong>Computer Vision Models:</strong> <a href="https://colab.research.google.com/github/mert-kurttutan/torchview/blob/main/docs/example_vision.ipynb"><img alt="Vision" src="https://colab.research.google.com/assets/colab-badge.svg" /></a></p>
<p><strong>NLP Models:</strong> <a href="https://colab.research.google.com/github/mert-kurttutan/torchview/blob/main/docs/example_text.ipynb"><img alt="NLP" src="https://colab.research.google.com/assets/colab-badge.svg" /></a></p>
<!-- single_input_all_cols.out -->

<p><strong>Note:</strong> Output graphviz visuals return images with desired sizes. But sometimes, on VSCode, some shapes are being cropped due to large size and svg rendering on by VSCode. To solve this, I suggest you run the following</p>
<pre><code class="language-python">import graphviz
graphviz.set_jupyter_format('png')
</code></pre>
<p>This problem does not occur on other platforms e.g. JupyterLab or Google Colab.</p>
<h2 id="supported-features">Supported Features</h2>
<ul>
<li>Almost all the models, RNN, Sequentials, Skip Connection, Hugging Face Models</li>
<li>Support for meta tensors -&gt; no memory consumption (for very Large models) (pytorch version $\geq$ 1.13) .</li>
<li>Shows operations between tensors (in addition to module calls)</li>
<li>Rolling/Unrolling feature. Recursively used modules can be rolled visually, see below.</li>
<li>Diverse set of inputs/output types, e.g. nested data structure (dict, list, etc), huggingface tokenizer outputs</li>
</ul>
<h2 id="documentation">Documentation</h2>
<pre><code class="language-python">def draw_graph(
    model: nn.Module,
    input_data: INPUT_DATA_TYPE | None = None,
    input_size: INPUT_SIZE_TYPE | None = None,
    graph_name: str = 'model',
    depth: int | float = 3,
    device: torch.device | str | None = None,
    dtypes: list[torch.dtype] | None = None,
    mode: str | None = None,
    strict: bool = True,
    expand_nested: bool = False,
    graph_dir: str | None = None,
    hide_module_functions: bool = True,
    hide_inner_tensors: bool = True,
    roll: bool = False,
    show_shapes: bool = True,
    save_graph: bool = False,
    filename: str | None = None,
    directory: str = '.',
    **kwargs: Any,
) -&gt; ComputationGraph:
    '''Returns visual representation of the input Pytorch Module with
    ComputationGraph object. ComputationGraph object contains:

    1) Root nodes (usually tensor node for input tensors) which connect to all
    the other nodes of computation graph of pytorch module recorded during forward
    propagation.

    2) graphviz.Digraph object that contains visual representation of computation
    graph of pytorch module. This graph visual shows modules/ module hierarchy,
    torch_functions, shapes and tensors recorded during forward prop, for examples
    see documentation, and colab notebooks.


    Args:
        model (nn.Module):
            Pytorch model to represent visually.

        input_data (data structure containing torch.Tensor):
            input for forward method of model. Wrap it in a list for
            multiple args or in a dict or kwargs

        input_size (Sequence of Sizes):
            Shape of input data as a List/Tuple/torch.Size
            (dtypes must match model input, default is FloatTensors).
            Default: None

        graph_name (str):
            Name for graphviz.Digraph object. Also default name graphviz file
            of Graph Visualization
            Default: 'model'

        depth (int):
            Upper limit for depth of nodes to be shown in visualization.
            Depth is measured how far is module/tensor inside the module hierarchy.
            For instance, main module has depth=0, whereas submodule of main module
            has depth=1, and so on.
            Default: 3

        device (str or torch.device):
            Device to place and input tensors. Defaults to
            gpu if cuda is seen by pytorch, otherwise to cpu.
            Default: None

        dtypes (list of torch.dtype):
            Uses dtypes to set the types of input tensor if
            input size is given.

        mode (str):
            Mode of model to use for forward prop. Defaults
            to Eval mode if not given
            Default: None

        strict (bool):
            if true, graphviz visual does not allow multiple edges
            between nodes. Mutiple edge occurs e.g. when there are tensors
            from module node to module node and hiding those tensors
            Default: True

        expand_nested(bool):
            if true shows nested modules with dashed borders

        graph_dir (str):
            Sets the direction of visual graph
            'TB' -&gt; Top to Bottom
            'LR' -&gt; Left to Right
            'BT' -&gt; Bottom to Top
            'RL' -&gt; Right to Left
            Default: None -&gt; TB

        hide_module_function (bool):
            Determines whether to hide module torch_functions. Some
            modules consist only of torch_functions (no submodule),
            e.g. nn.Conv2d.
            True =&gt; Dont include module functions in graphviz
            False =&gt; Include modules function in graphviz
            Default: True

        hide_inner_tensors (bool):
            Inner tensor is all the tensors of computation graph
            but input and output tensors
            True =&gt; Does not show inner tensors in graphviz
            False =&gt; Shows inner tensors in graphviz
            Default: True

        roll (bool):
            If true, rolls recursive modules.
            Default: False

        show_shapes (bool):
            True =&gt; Show shape of tensor, input, and output
            False =&gt; Dont show
            Default: True

        save_graph (bool):
            True =&gt; Saves output file of graphviz graph
            False =&gt; Does not save
            Default: False

        filename (str):
            name of the file to store dot syntax representation and
            image file of graphviz graph. Defaults to graph_name

        directory (str):
            directory in which to store graphviz output files.
            Default: .

    Returns:
        ComputationGraph object that contains visualization of the input
        pytorch model in the form of graphviz Digraph object
    '''
</code></pre>
<h2 id="examples">Examples</h2>
<h3 id="rolled-version-of-recursive-networks">Rolled Version of Recursive Networks</h3>
<pre><code class="language-python">from torchview import draw_graph

model_graph = draw_graph(
    SimpleRNN(), input_size=(2, 3),
    graph_name='RecursiveNet',
    roll=True
)
model_graph.visual_graph
</code></pre>
<p><img alt="rnns" src="https://user-images.githubusercontent.com/88637659/206644016-23a89c81-1d6a-4558-82f4-33f179b345f3.png" /></p>
<h3 id="showhide-intermediate-hidden-tensors-and-functionals">Show/Hide intermediate (hidden) tensors and Functionals</h3>
<pre><code class="language-python"># Show inner tensors and Functionals
model_graph = draw_graph(
    MLP(), input_size=(2, 128),
    graph_name='MLP',
    hide_inner_tensors=False,
    hide_module_functions=False,
)

model_graph.visual_graph
</code></pre>
<p><img alt="download" src="https://user-images.githubusercontent.com/88637659/206188796-4b9e57ef-8d33-469b-b8e0-2c47b06fe70b.png" /></p>
<h3 id="resnet-skip-connection-support-for-torch-operations-nested-modules">ResNet / Skip Connection / Support for Torch operations / Nested Modules</h3>
<pre><code class="language-python">import torchvision

model_graph = draw_graph(resnet18(), input_size=(1,3,32,32), expand_nested=True)
model_graph.visual_graph
</code></pre>
<p><img alt="expand_nested_resnet_model gv" src="https://user-images.githubusercontent.com/88637659/206036653-293f8ce7-04dd-4ac6-9de8-0061de505bba.png" /></p>
<h2 id="todo">TODO</h2>
<ul>
<li>[ ] Display Module parameter info</li>
<li>[ ] Support for Graph Neural Network (GNN)</li>
<li>[ ] Support for Undirected edges for GNNs</li>
<li>[ ] Support for torch-based functions[^1]</li>
</ul>
<p>[^1]: Here, torch-based functions refers to any function that uses only torch functions and modules. This is more general than modules.</p>
<h2 id="contributing">Contributing</h2>
<p>All issues and pull requests are much appreciated! If you are wondering how to build the project:</p>
<ul>
<li>torchview is actively developed using the latest version of Python.</li>
<li>Changes should be backward compatible to Python 3.7, and will follow Python's End-of-Life guidance for old versions.</li>
<li>Run <code>pip install -r requirements-dev.txt</code>. We use the latest versions of all dev packages.</li>
<li>To run unit tests, run <code>pytest</code>.</li>
<li>To update the expected output files, run <code>pytest --overwrite</code>.</li>
<li>To skip output file tests, use <code>pytest --no-output</code></li>
</ul>
<h2 id="references">References</h2>
<ul>
<li>Parts related to input processing and validation are taken/inspired from torchinfo repository!!.</li>
<li>Many of the software related parts (e.g. testing) are also taken/inspired from torchinfo repository. So big thanks to @TylerYep!!!</li>
<li>The algorithm for constructing visual graphs is thanks to <code>__torch_function__</code> and subclassing <code>torch.Tensor</code>. Big thanks to all those who developed this API!!.</li>
</ul>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": ".", "features": [], "search": "assets/javascripts/workers/search.f8cc74c7.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="assets/javascripts/bundle.c8b220af.min.js"></script>
      
    
  </body>
</html>